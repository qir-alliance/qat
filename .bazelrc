# Platform independent configuration
build --workspace_status_command "python config/workspace-status.py"

# We would turn this on globally, but unfortunattely
# it kills external libraries
# build --cxxopt=-Wall
# build --cxxopt=-Wextra
# build --cxxopt=-Wconversion
# build --cxxopt=-Wpedantic
# build --cxxopt=-Werror

# C++ 17
build:clang --cxxopt=-std=c++17
build:clang --host_cxxopt=-std=c++17
build:msvc --cxxopt=/std:c++17
build:msvc --host_cxxopt=/std:c++17
build:msvc --verbose_failures

# Ideally these should be moved to user configuration
build:release --cxxopt=-O3
build:release --cxxopt=-DNDEBUG
build:debug -c dbg
build:debug --copt=-g 
build:debug --cxxopt=-g 
build:debug --strip=never
build:debug --cxxopt=-fsanitize=address,undefined
build:debug --cxxopt=-fno-omit-frame-pointer
build:debug --cxxopt=-fno-sanitize-recover=all
build:debug --copt=-O0
build:debug --cxxopt=-O0
build:debug --linkopt=-fsanitize=address,undefined
build:debug --features asan,usan
build:debug --spawn_strategy=standalone
build:debug --apple_enable_auto_dsym_dbg
build:debug --apple_generate_dsym 

# ## SEE https://github.com/RobotLocomotion/drake/tree/master/tools/dynamic_analysis



# To manually set the target CPU, use
# build --apple_platform_type=macos
# build --cpu=darwin_arm64 --host_cpu=darwin_arm64

# Tries to import additional config
try-import %workspace%/.bazelrc.configure
try-import %workspace%/.bazelrc.user
